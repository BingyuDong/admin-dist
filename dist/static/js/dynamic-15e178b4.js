import{j as e,T as r,E as l,Q as t,n as o}from"./element-plus-4fb390ec.js";import{_ as s}from"./form.vue_vue_type_script_setup_true_lang-545330d1.js";import{d as a,r as i,b as p,o as n,c as m,V as u,P as c,T as d,u as _,a as f}from"./@vue-a87a2c7f.js";import{_ as b}from"./index.vue_vue_type_script_setup_true_lang-1935be80.js";import"./lodash-es-3d6dbac5.js";import"./@element-plus-4fb40093.js";import"./@popperjs-b78c3215.js";import"./@ctrl-91de2ec7.js";import"./dayjs-53faf157.js";import"./async-validator-cf877c1f.js";import"./memoize-one-63ab667a.js";import"./escape-html-d8f7a771.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui-24fcdcc4.js";const g=a({__name:"formDynamic",emits:["submit"],setup(r,{emit:l}){let t=i();const o=l;let a=i({model:{controlName:"input",prop:"",label:"",bindControlOptions__placeholder:"请输入内容",rules__required:!1,rules__trigger:"blur",canDeleted:!0}}),f=i([{controlName:"input",prop:"prop",label:"键名（prop）",bindControlOptions:{placeholder:"请输入表单prop"},rules:[{required:!0,message:"请输入prop",trigger:"blur"}]},{controlName:"input",prop:"label",label:"标签文本（label）",bindControlOptions:{placeholder:"请输入表单label"},rules:[{required:!0,message:"请输入label",trigger:"blur"}]},{controlName:"input",prop:"bindControlOptions__placeholder",label:"表单内容提示",bindControlOptions:{placeholder:"请输入表单内容提示"}},{controlName:"switch",prop:"canDeleted",label:"是否可以被删除",rules:[{required:!0}]},{controlName:"switch",prop:"rules__required",label:"表单校验-是否必填",rules:[{required:!0}]},{controlName:"input",prop:"rules__message",label:"表单校验-失败提示",bindControlOptions:{placeholder:"请输入表单校验失败提示"},rules:[{required:!0,message:"请输入表单校验失败提示",trigger:"blur"}],hide:p((()=>!a.value.model.rules__required))}]);const b=async()=>{if(await t.value.submitForm()){let e={...a.value.model},r=[];Object.keys(e).forEach((e=>{e.includes("__")&&r.push(e)}));let l={};r.forEach((r=>{let t=r.split("__");l[t[0]]?l[t[0]][t[1]]=e[r]:l[t[0]]={[t[1]]:e[r]},delete e[r]})),l={...e,...l},o("submit",l)}},g=()=>{t.value.resetForm()};return(r,l)=>{const o=e;return n(),m("div",null,[u(s,{ref_key:"customFormRef",ref:t,formOptions:_(a),formItemOptionsList:_(f)},{action:c((()=>[u(o,{type:"primary",onClick:b},{default:c((()=>[d("提交")])),_:1}),u(o,{type:"danger",onClick:g},{default:c((()=>[d("重置")])),_:1})])),_:1},8,["formOptions","formItemOptionsList"])])}}}),y={class:"pc:flex"},h={class:"w-full h-full"},v=a({__name:"dynamic",setup(a){let v=i(),O=i({model:{},dynamicForm:!0}),j=i([{controlName:"input",prop:"name",label:"name",bindControlOptions:{placeholder:"请输入name"},rules:[{required:!0,message:"请输入name",trigger:"blur"}],canDeleted:!0}]);const C=async()=>{await v.value.submitForm()&&r({title:"成功",message:`表单验证成功，当前表单对象值为${JSON.stringify(O.value.model)}`,type:"success"})},N=()=>{v.value.resetForm()};p((()=>JSON.stringify(j.value,null,2)));const q=p((()=>"formItemOptionsList = "+JSON.stringify(j.value,null,2))),w=e=>{j.value.some((r=>r.prop==e.prop))?l.error("已经存在该键名的表单项，无法添加！"):j.value.push(e)};return(r,l)=>{const a=t,i=o,p=e;return n(),m("div",null,[u(i,{class:"mb-[10px]"},{default:c((()=>[u(a,{class:"mb-2",closable:!1,title:"通过动态添加/删除表单配置项动态生成与删除表单项,当前只支持input类型的表单项动态插入",type:"warning"})])),_:1}),f("div",y,[f("div",h,[u(i,{class:"w-full h-full"},{header:c((()=>[d("表单结构")])),default:c((()=>[u(s,{ref_key:"customFormRef",ref:v,formOptions:_(O),formItemOptionsList:_(j)},{action:c((()=>[u(p,{type:"primary",onClick:C},{default:c((()=>[d("提交")])),_:1}),u(p,{type:"danger",onClick:N},{default:c((()=>[d("重置")])),_:1})])),_:1},8,["formOptions","formItemOptionsList"])])),_:1}),u(i,{class:"mt-[10px]"},{header:c((()=>[d("动态插入")])),default:c((()=>[u(g,{onSubmit:w})])),_:1})]),u(i,{class:"w-full pc:ml-[10px] mt-[10px] pc:mt-0"},{header:c((()=>[d("表单数据")])),default:c((()=>[u(b,{code:_(q)},null,8,["code"])])),_:1})])])}}});export{v as default};
